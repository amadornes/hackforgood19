<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" type="text/css" href="css/styles.css"/>
    <title>FoodForGood</title>
</head>
<header>
    <a href="index.html" id="header"><h1>FoodForGood</h1></a>
    <script src="https://www.gstatic.com/firebasejs/5.8.4/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/5.8.4/firebase-firestore.js"></script>
    
    <script src="https://www.gstatic.com/firebasejs/5.9.1/firebase.js"></script>
    <script>
        // Initialize Firebase
        var config = {
            apiKey: "AIzaSyDv2KMF781Ks85L4YAKKaV6319XcsDwze4",
            authDomain: "hackforgood19.firebaseapp.com",
            databaseURL: "https://hackforgood19.firebaseio.com",
            projectId: "hackforgood19",
            storageBucket: "hackforgood19.appspot.com",
            messagingSenderId: "830068370062"
        };
        firebase.initializeApp(config);
    </script>
</header>
<body>
	<section class="seccion">
	    <h3>Ver restaurante</h3>

	    <input type="text" id="idR">
        <!-- <button onclick="verMenu()">Ver menú</button> -->
        
        <button onclick="verRestaurante()">Ver restaurante</button>
		<p id="error">No puede estar vacio</p>
    </section>	
    
    <section id="salida">
    </section>

    <script>

        function verRestaurante(){
            var idRest = document.getElementById('idR').value;
            var nombre;
            var platos = [];
            var cadenaSalida = "";
            var obj;

            if(idRest != "" && idRest != " "){
                // Cosultar base de datos
	            var docRef = firebase.firestore().collection("restaurante").doc(idRest).collection("menu");
                docRef.get()
                .then(function(querySnapshot) {
                    querySnapshot.forEach(function(doc) {
                        // doc.data() is never undefined for query doc snapshots
                        console.log(doc.id, " => ", doc.data());

                        obj = JSON.parse(JSON.stringify( doc.data()));

                        cadenaSalida = "<br><h4> Nombre: </h4> <p>" + obj.nombre + "</p>";

                        cadenaSalida += "<h4> Tipo: </h4> <p>" + obj.tipo + "</p>";

                        cadenaSalida += "<h4> Calorias: </h4> <p>" + obj.calorias + "</p>";

                        cadenaSalida += "<h4>Ingredientes:</h4>"


                        for(var i = 0; i<obj.ingredientes.length;i++){

                        	cadenaSalida += "<p>&nbsp&nbsp&nbsp&nbsp&nbsp" + obj.ingredientes[i] + "</p>";


                        }

                        cadenaSalida += "<h4>Alergenos:</h4>"
                        for(var i = 0; i<obj.alergenos.length;i++){

                        	cadenaSalida += "<p>&nbsp&nbsp&nbsp&nbsp&nbsp" + obj.alergenos[i] + "</p>";


                        }

                        cadenaSalida += "<h4> descripcion: </h4> <p>" + obj.descripcion + "</p>";


                        cadenaSalida += "<h4> Precio: </h4> <p>" + obj.precio + "</p>";

                        /*cadenaSalida = "<p>";
                        cadenaSalida += JSON.stringify(doc.data());
                        cadenaSalida += "</p>";
                        console.log(" :::::::::::::::::::::::::::::::::::::. ");
		                console.log("LOG: " + cadenaSalida);*/
			            document.getElementById("salida").innerHTML += cadenaSalida;
                    });
                })
                .catch(function(error) {
                    console.log("Error getting documents: ", error);
                });
                /*
	            cadenaSalida = "<h4>Restaurante " + nombre + "</h4><br><h5>Platos:</h5><br>";

	            // Imprimir platos
	            for (var i=0; i<platos.length; i++){
	                var platoConsultado = platos[i];
	                cadenaSalida = cadenaSalida + platoConsultado + "<br>";
	            }
                */


             }
            else
            {
                document.getElementById("error").style.visibility = "visible";
            }

        }

        /*
        function verMenu(){
            var alergenos = [];
            var ingredientes = [];
            var nombre;
            var tipo;
            var calorias;
            
            // Consultar base de datos

            // Escribir
            var cadenaSalida;

            cadenaSalida = "<h4>Nombre:</h4><p>" + nombre + "</p><br><h4>Tipo:</h4><p>" + tipo + "</p><br><h4>Calorías</h4><p>" + calorias + "</p><br><h4>Alérgenos</h4>";
            // Sacar alérgenos
            for (i=0;i<alergenos.length;i++){
                var nuevaCadena = "<p>" + alergenos[i] + "</p><br>";
                cadenaSalida = cadenaSalida += nuevaCadena;
            }
            // Sacar ingredientes
            for (j=0; j<ingredientes; j++){
                var nuevaCadena = "<p>" + ingredientes[j] + "</p><br>";
                cadenaSalida = cadenaSalida += nuevaCadena;
            }
            
            document.getElementById("salida").innerHTML = cadenaSalida;

        }*/
    </script>
    
</body>
</html>